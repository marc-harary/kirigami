# Kirigami

[![arXiv](https://img.shields.io/badge/arXiv-2406.02381-b31b1b.svg)](https://arxiv.org/abs/2406.02381)

[**Kirigami: large convolutional kernels improve deep learning-based RNA secondary structure prediction**](https://arxiv.org/abs/2406.02381)

Kirigami is a state-of-the-art (SOTA) AI model for RNA secondary structure prediction. On a standardized test set from [bpRNA](https://bprna.cgrb.oregonstate.edu/), Kirigami exceeds the performance of other programs like [SPOT-RNA](https://github.com/jaswindersingh2/SPOT-RNA), [MXfold2](https://github.com/mxfold/mxfold2), and [UFold](https://github.com/uci-cbcl/UFold). 


## Installation

The easiest way to download and interact with Kirigami is via [PyTorch Hub](https://pytorch.org/hub/). Simply run
```python
import torch
model = torch.hub.load('marc-harary/kirigami', 'kirigami', pretrained=True)
```

## Usage

For a given FASTA sequence, run
```python
model('GGGGCGAGCUGCAGCCCCAGUGAAUCAAGUGCAGC')
# '.((((........))))..................'
```
to invoke a convenience `__call__` method that embeds the FASTA string and returns a prediction in [dot-bracket notation (DBN)](https://gensoft.pasteur.fr/docs/ViennaRNA/2.4.14/rna_structure_notations.html#:~:text=Structure%20(WUSS)%20notation-,Dot%2DBracket%20Notation%20(a.k.a.%20Dot%2DParenthesis%20Notation),and%20unpaired%20nucleotides%20by%20dots%20.%20.).

## (Re)training

All experiments were performed via [PyTorch Lightning](https://lightning.ai/docs/pytorch/stable). Although the weights of the production model are located at `weights/main.ckpt`, Kirigami can be retrained with varying hyperparameters. Run 
```bash
python run.py --help
```
for an exhaustive list of configurations, displayed via [Lightning's CLI](https://lightning.ai/docs/pytorch/stable/api/lightning.pytorch.cli.LightningCLI.html#lightning.pytorch.cli.LightningCLI). The appropriate configuration files are located in `configs`. 

## Data

Data used for training, validation, and testing are taken from the [bpRNA](https://bprna.cgrb.oregonstate.edu/) database in the form of the standard TR0, VL0, and TS0 datasets used by [SPOT-RNA](https://github.com/jaswindersingh2/SPOT-RNA), [MXfold2](https://github.com/mxfold/mxfold2), and [UFold](https://github.com/uci-cbcl/UFold). Respectively, these contain 10,814, 1,300, and 1,305 non-redundant structures. The `.dbn` files located in this repo were generated by scraping the data originally uploaded by the authors of SPOT-RNA. The `RNAStrAlign`, `archiveII`, `bpRNAnew`, and `bpRNAnew_mutate` datasets, scraped from UFold, are likewise in the `data` directory.

## Name
From [Wikipedia](https://en.wikipedia.org/wiki/Kirigami):

> Kirigami (切り紙) is a variation of origami, the Japanese art of folding paper. In kirigami, the paper is cut as well as being folded, resulting in a three-dimensional design that stands away from the page.

The Kirigami pipeline both folds RNA molecules via a fully convolutional neural network (FCN) and uses Nussinov-style dynamic programming to recursively cut them into subsequences for post-processing.
